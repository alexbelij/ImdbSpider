# 电影数据可视化

> 2015年夏学期  浙江大学数学系研究生课程  可视化  课程作业回顾

## 要求

- python 2.7
- scrapy
- matplotlib
- 绘制软件AndeaMosaic

数据来源：陈为.[好莱坞电影数据集](https://pan.baidu.com/share/link?shareid=3925629793&uk=3610345149)

## 0 数据预处理

`vis/data_cleansing.py`

- 不统计奥斯卡、学院奖，这两列都舍弃
- 数据来源列不做研究，舍弃
- 07、08年比09-11年多了几列数据，这几列数据是票房的重复数据，和前边大同小异，而且单位混乱，舍弃掉
- 11年的行排布Average没像其他几个文件一样排在Film后，需要修正
- 对应该是字符串型的数据（如Film, Studio, Story, Genre列）首字母大写
- 无效数据在具体分析时再进行一次过滤，提前过滤会导致Average不准确

处理完毕后写入新的csv文件，作为可视化的数据来源。

## 1 总票房

由五年间的电影海报组成一幅图，显示出总票房的数值

### 流程：

- 获取csv电影名称
- 根据电影名称编写爬虫从imdb抓取海报（豆瓣爬虫`spiders/douban_spider.py`会被屏蔽）
> 影片名称有一些影响爬虫结果的字符，比如(、:、_等，需要用replace函数先转化成可用的字符（(及之后的删掉；:转为%3A；_转为+）

> 减小request量的trick：看网页源码，总结海报的url规律，发现直接修改预览海报的url里的尺寸值，就成了尺寸较大的海报的url

- 使用AndreaMosaic软件拼接图片

### 结果

2007-2011全球总票房（652张海报，由于量还是不够大，因此允许镜像和旋转180°，且一张海报复用不超过2次，颜色调整度10%）

![横版](/img/totalBox.png)

### TODO

- 搜索结果同名电视剧排第一，预览图都是空白png图片。如果结果url中有.png，就修改xpath，往下搜索直到.jpg为止
- 近几年又翻拍了一部。给一个容差来匹配年份（不能简单地通过确定的年份筛选，因为有些电影在imdb上的年份并不是csv文件描述的）进行筛选
- 片名正好是影人名字。可以通过给url末尾添加限制字符&s=tt限定搜索范围
- 最终结果的底图用的是黑白，可能有更合适的配色

## 2 首映周票房-观众评分

`vis/main.py`

绘制首映周票房-观众评分分布图像

可以对首映周票房分布、观众评分分布有直观的了解，并且能够找到“叫好又叫座”的电影。使用颜色根据区域变化的散点图来绘制图像

![票房-评分](/img/scores.png)

## 3 制作公司PK

将数据保存出来，贴到 http://tagcrowd.com/ 进行wordle可视化

![票房-评分](/img/company.png)

从数据可以看出独立制作公司比例基本上保持，Fox在07年较为可怜，没有数据。著名公司Mgm这几年制作量小，11年就消失了，因为10年米高梅就申请了破产托管。其他几个巨头公司稍微有波动

## 4 类型片比较

`vis/main.py`

- 为了均衡单位同时又能突出对比，使用极值进行归一化数据
- 使用雷达图能够更好看出各个类型的综合实力

### 流程：

- 过滤掉没有类型、分数、国内外票房、预算、盈利无效的数据
- 丢弃累计<5部的类型片数据
- 归一化数据，使用(x-xmin)/(xmax-xmin)归一化，比较相对数据
- 选择绘制数量排在前10的类型片数据

### 结果

![票房-评分](/img/genre.png)

相比之下，恐怖片非常小众；动画片和惊悚片这些预算很高影片比较叫好叫座；传记高盈利高评分，犯罪片也是高盈利，且和传记一样在国内较受欢迎